# MVC goodies

there is a great variety of Spring mvc introduction level tutorials on the internet. There is no point in having another one here. I will write some notes that help me understand spring mvc better.

When building an mvc application, the best practice is to separate your classes into 3 main categories: **controller - service - model**.

* Model related things are entities and repositories. Entities contain application independent business logic, like one User can have 1 - many emails, and is required to have an id.

* Services are classes that contain application specific business logic. Methods in service classes are perfect places for transactional logic.
Services interact with and manipulate entities to perform use cases. It is a good practice to name their methods as use cases. An alternative way to think about services as controllers but not for the web.

* Controller's main goal is to handle web things: map actions to url patterns, handle exceptions in service methods, decide which views to return.

In the best case scenario, controllers never interact with the entities directly, only through services. When a request is coming in appropriate method is selected to handle it, this method may perform validations and delegates to a service designed specifically to handle this use case. Service knows how to manipulate entities to perform the use case. This action may result in some objects returned to the controller, that in turn decides what view to return, what messages to show to the user, etc.


##### @ControllerAdvice goodies 

Controller methods can become busy if we try to perform everything in them. Spring allows us to move some of the commonly needed functionality outside of controllers using @ControllerAdvice.

@ControllerAdvice class is a special class that can define
**@ExceptionHandler, @InitBinder and @ModelAttribute** methods. These advice methods are applied to all @RequestMapping methods in all @Controller classes.

@ExceptionHandler methods handle exceptions: in case of an exception, they return an appropriate view. Inside of the @ControllerAdvice they handle exceptions from all controllers, while if inside of a controller, only exceptions generated by that specific controller.

@ModelAttribute, if used on a method in the @ControllerAdvice class, is responsible for populating the model attribute with commonly needed data or entities. These methods are invoked before @RequestMapping methods, so you can expect attributes to be present in the model. These methods can, like @RequestMappping methods, access request parameters and model, in fact that is one of the ways they add attributes to the model.
Like @ExceptionHandler, @ModelAttribute can be inside of the @ControllerAdvice, being invoked on all request in all controllers, or it can be inside of the @Controller, being invoked only before the request in that controller.
